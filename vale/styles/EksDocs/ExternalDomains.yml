extends: existence
message: "External domain detected: '%s -- Review non-aws domains carefully"
level: error
scope: raw
#ignorecase: true
tokens:
  - '(?:^|\s)(http(s)?://[^\s]+)(?:$|\s)'
exceptions:
  - https://aws.github.io/
  - https://kubernetes-sigs.github.io/
  - https://aws-observability.github.io/
  - https://github.com/aws/
  - https://github.com/aws-samples/
  - https://github.com/kubernetes/
  - https://repost.aws/
  - https://github.com/bottlerocket-os/
  - https://kubernetes.io
  - https://karpenter.sh
  - https://anywhere.eks.amazonaws.com
  - https://aws-ia.github.io
  - https://eksctl.io
  - https://catalog.workshops.aws
  - https://github.com/awslabs/
  - https://github.com/aws-controllers-k8s/
  - https://raw.githubusercontent.com/aws-observability/
  - https://github.com/kubernetes-sigs/
  - https://d1.awsstatic.com/
  - https://docs.github.com/
  - https://code.visualstudio.com/
  - https://cli.github.com/
  - https://marketplace.visualstudio.com/
  - https://docs.asciidoctor.org/
  - https://brew.sh/
  - https://github.dev/aws/
  - https://catalog.us-east-1.prod.workshops.aws/
  - http://developers.eksworkshop.com
  - https://s3.us-west-2.amazonaws.com/amazon-eks/
  - https://www.eksworkshop.com
  - https://community.aws/
  - https://www.youtube.com/
  - https://kind.sigs.k8s.io
  - https://minikube.sigs.k8s.io
  - https://www.terraform.io
  - https://developers.eksworkshop.com
  - https://docs.aws.amazon.com/
  - https://groups.google.com/forum/#!topic/kubernetes-security-announce
  - https://raw.githubusercontent.com/kubernetes-sigs
  - https://helm.sh
  - https://public.ecr.aws
  - https://gallery.ecr.aws
  - https://amazon-eks.s3.us-west-2.amazonaws.com/eks-connector/
  - https://www.intel.com/
  - https://www.tensorflow.org/
  - https://docs.upbound.io/
  - https://docs.upwind.io/
  - https://tetratelabs.io/
  - https://goteleport.com/
  - https://docs.splunk.com/
  - https://docs.stormforge.io/
  - https://docs.snyk.io/
  - https://docs.solo.io/
  - alas.aws.amazon.com
  - amazon.awsapps.com
  - apparmor.net
  - appdynamics.com
  - aws-otel.github.io
  - awsdocs-neuron.readthedocs-hosted.com
  - awslabs.github.io
  - brew.sh
  - catalog.redhat.com
  - chocolatey.org
  - cloud-images.ubuntu.com
  - cloudinit.readthedocs.io
  - containerd.io
  - distro.eks.amazonaws.com
  - docs.docker.com
  - docs.netapp.com
  - docs.newrelic.com
  - docs.pingidentity.com
  - docs.podman.io
  - documentation.solarwinds.com
  - documentation.ubuntu.com
  - ebpf.io
  - eks.amazonaws.com
  - eksworkshop.com
  - etcd.io
  - explore.skillbuilder.aws
  - gateway-api.sigs.k8s.io
  - github.com
  - grafana.com
  - hub.docker.com
  - k8s.io
  - kubernetes-csi.github.io
  - learn.microsoft.com
  - oidc.eks.amazonaws.com
  - oidc.eks.region-code.amazonaws.com
  - opencontainers.org
  - openid.net
  - operatorhub.io
  - packer.io
  - portal.msrc.microsoft.com
  - prometheus.io
  - pytorch.org
  - registry.terraform.io
  - requests.readthedocs.io
  - rubygems.org
  - support.microsoft.com
  - tensorflow.org
  - ubuntu.com
  - www.canonical.com
  - www.cisecurity.org
  - www.itu.int
  - www.juniper.net
  - www.python.org
  - www.rfc-editor.org
  - xilinx.github.io